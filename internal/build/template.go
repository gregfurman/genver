package build

import "text/template"

const templateContent = `// Code generated by github.com/gregfurman/genver DO NOT EDIT.
// Version:			{{ .VersionInformation.Version }}
// Revision:		{{ .VersionInformation.Revision }}
// LastCommitTime:	{{ .VersionInformation.LastCommit.Format "Jan 02, 2006 15:04:05 UTC" }}
// IsDirtyBuild:	{{ .VersionInformation.DirtyBuild }}
package {{.Package}}

const (
	Version     	= {{ .VersionInformation.Version | printf "%q" }}
	Revision    	= {{ .VersionInformation.Revision | printf "%q" }}
	LastCommit  	= {{ .VersionInformation.LastCommit.Format "Jan 02, 2006 15:04:05 UTC" | printf "%q" }}
	IsDirtyBuild    = {{ .VersionInformation.DirtyBuild }}
)
{{ range .Dependencies }}
// Currently using {{ .Path }} {{ .Version }} 
const (
    {{ .Name }}_Version = "{{ .Version }}"
    {{ .Name }}_Path    = "{{ .Path }}"
)
{{ end }}`

func retrieveTemplate() (*template.Template, error) {
	tmpl, err := template.New("genver").Parse(string(templateContent))
	if err != nil {
		return nil, err
	}

	return tmpl, nil
}
